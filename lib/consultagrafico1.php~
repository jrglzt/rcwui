<?php
  include("settings.inc");

  $secPeriods = array("1800", "3600", "10800", "43200",
			"86400", "604800", "2592000", "31536000");
  $namePeriods = array("30 minutes", "1 hour", "3 hours", "12 hours",
			"1 day", "7 days", "1 month", "1 year");
  $formPeriod = $_GET["formPeriod"];
  if (!in_array($formPeriod, $secPeriods)) {
    # Set default period - 1h
    $formPeriod = "2592000"; 
  }
  $timeNow = time();
  $timePast = $timeNow - $formPeriod;
  mysql_connect($dbHost,$dbUser, $dbPass);
  @mysql_select_db($dbName) or die("Unable to connect to database");

  $dbQuery = "SELECT COUNT(alert.rule_id) AS count, description FROM alert,signature WHERE alert.rule_id = signature.rule_id AND timestamp BETWEEN $timePast AND $timeNow GROUP BY alert.rule_id ORDER BY count DESC LIMIT 10";
  $dbResult = mysql_query($dbQuery);
  while ($row = mysql_fetch_row($dbResult)) 
  {
    //   { label: "Series1",  data: 10}
$results[] = array('label'=>$row['description'],'data'=>$row['count']);
	echo '<pre>';
		print_r($results);
	echo '</pre>'; 
//   $results[] = array('Label:' . '"' . $row['description'] . '"', "data:" . $row['count']);
  }

  mysql_close();

?>
